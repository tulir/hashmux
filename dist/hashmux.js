"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),pieceMatcher=/\{([a-zA-Z]+?)(:[^}]+?)?\}/,regexEscape=/[-[]\/\{\}\(\)\*\+\?\.\\\^\$\|]/,Hashmux=function(){function e(){_classCallCheck(this,e),this.oldHash=window.location.hash,this.ignoreUpdate=!1,this.handlers=[],this.specialHandlers={prehandle:function(){},posthandle:function(){}},this.errors={404:function(e){return console.error("Page",e.page,"not found!")}}}return _createClass(e,[{key:"error",value:function(e,t){this.errors.hasOwnProperty(e)?this.errors[e](t):this.errors[520](t)}},{key:"handleError",value:function(e,t){this.errors[e]=t}},{key:"handle",value:function(e,t,n){void 0===e||0===e.length?e="/":"function"==typeof e&&(t=e,e="/"),"function"!=typeof t&&(t=function(){console.error("No handler function provided for",e)});var r=e.split("/").slice(1),i=[],o=[],a=n?"i":"",s=!1;r.length>1&&0===r[r.length-1].length&&(r=r.slice(0,r.length-1),s=!0);for(var l=0;l<r.length;l++){var h=r[l];if(h){var u=pieceMatcher.exec(h);null!==u&&u.length>1?(u=u.slice(1),o[l]=u[0],i[l]=void 0!==u[l]&&u[1].length>0?new RegExp("^"+u[1].substr(1)+"$",a):new RegExp("^.+$",a)):i[l]=new RegExp("^"+h.replace(regexEscape,"\\$&")+"$",a)}}this.handlers.push(new Handler(o,i,t,s))}},{key:"handleRaw",value:function(e){this.handlers.push(e)}},{key:"update",value:function(){if(this.ignoreUpdate)return void(this.ignoreUpdate=!1);var e=window.location.hash;0===e.length&&(e="#/");var t=e.split("/").slice(1),n=!0,r=!1,i=void 0;try{for(var o,a=this.handlers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.handle(t);if(void 0!==l){if(this.specialHandlers.prehandle(e,l))return this.ignoreUpdate=!0,void(window.location.hash=this.oldHash);var h=s.func(l);if(this.oldHash=e,this.specialHandlers.posthandle(e,l,h))return;return void(void 0!==h&&"object"===("undefined"==typeof h?"undefined":_typeof(h))&&(h.page=e.substr(1),void 0!==h.status&&200!==h.status&&this.error(h.status,h)))}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this.error(404,{page:e.substr(1)})}},{key:"listen",value:function(){var e=this;window.onhashchange=function(){return e.update()},this.update()}}]),e}(),Handler=function(){function e(t,n,r,i){_classCallCheck(this,e),void 0===t&&(t=[]),this.args=t,this.regex=n,this.func=r,this.trailingAnything=!!i}return _createClass(e,[{key:"handle",value:function(e){if(this.regex.length>e.length)return void 0;if(this.regex.length<e.length&&!this.trailingAnything)return void 0;for(var t=[],n=0;n<this.regex.length;n++){var r=this.regex[n].exec(e[n]);if(null===r||0===r.length)return void 0;var i=t.length;this.args.length>n&&void 0!==this.args[n]&&(i=this.args[n]),t[i]=decodeURIComponent(r[0])}if(this.trailingAnything)for(;n<e.length;n++)t[n]=decodeURIComponent(e[n]);return t}}]),e}();"undefined"!=typeof module&&module.exports&&(module.exports={Hashmux:Hashmux,Handler:Handler});